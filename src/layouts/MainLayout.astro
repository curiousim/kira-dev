---
import HamburgerMenu from "../components/common/HamburgerMenu.astro";
---

<div class="shell">
	<!-- Top controls: theme + hamburger. Becomes the right-column header on desktop -->
	<header class="controls" aria-label="Site controls">
		<slot name="theme"></slot>
		<div class="controls__menu" aria-label="Primary navigation">
			<HamburgerMenu />
		</div>
	</header>

	<!-- Main reading area -->
	<main class="main" id="content">
		<slot name="main"></slot>
	</main>

	<!-- Latest articles block -->
	<section class="latest" aria-labelledby="latest-heading">
		<slot name="latest"></slot>
	</section>

	<!-- Back to top / CTA -->
	<div class="back">
		<slot name="back"></slot>
	</div>
</div>

<style>
	:root {
		--gap: var(--default-layout-gap, 24px);
		--pad: var(--default-layout-gap, 24px);
		--col-min: 200px; /* minimum for the right column */
		--sidebar-stick: 24px;
	}

	.shell {
		height: 100vh;
		width: var(--shell-max);
		padding: var(--pad);
		display: grid;
		gap: var(--gap);
		grid-template-columns: minmax(0, 2fr) minmax(var(--col-min), 1fr);
		grid-template-rows: 0.8fr 4.2fr;
		grid-template-areas:
			"main controls"
			"main latest";
	}

	.main {
		grid-area: main;
		min-width: 0;
	}
	.controls {
		grid-area: controls;
		display: grid;
		grid-template-columns: 1fr;
		align-items: start;
		gap: var(--gap);
		height: fit-content;
		width: 100%;
	}
	.latest {
		grid-area: latest;
	}

	.back {
		display: none; /* Hidden on large screens */
	}

	/* Hide the hamburger on desktop unless you want it visible */
	.controls__menu {
		display: none;
	}

	/* MOBILE / SMALL screens */
	@media (max-width: 900px) {
		.shell {
			gap: var(--gap);
			grid-template-columns: 1fr;
			grid-template-rows: 60px auto;
			grid-template-areas:
				"controls"
				"main"
				"latest"
				"back";
		}

		.controls {
			grid-template-columns: auto 1fr; /* theme then menu */
			align-items: center;
			height: fit-content;
		}

		.controls__menu {
			display: block;
			justify-self: end;
		}
		.latest,
		.back,
		.controls {
			position: static;
		} /* disable sticky on mobile */
	}

	/* Utilities */
	.visually-hidden {
		position: absolute !important;
		width: 1px;
		height: 1px;
		padding: 0;
		margin: -1px;
		overflow: hidden;
		clip: rect(0 0 0 0);
		white-space: nowrap;
		border: 0;
	}

	@media (prefers-reduced-motion: reduce) {
		* {
			scroll-behavior: auto !important;
		}
	}
</style>
