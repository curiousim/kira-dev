---
interface Props {
	links?: Array<{ href: string; title: string }>;
}

const { links = [] } = Astro.props;
---

<div class="hamburger-wrapper">
	<button
		class="hamburger-button"
		aria-label="Toggle menu"
		aria-expanded="false">
		<span class="hamburger-line"></span>
		<span class="hamburger-line"></span>
		<span class="hamburger-line"></span>
	</button>

	<nav class="mobile-menu" aria-hidden="true">
		<ul class="menu-list">
			{links.map((link) => (
				<li class="menu-item">
					<a href={link.href} class="menu-link">
						{link.title}
					</a>
				</li>
			))}
		</ul>
	</nav>
</div>

<style>
	.hamburger-wrapper {
		position: relative;
		display: flex;
		align-items: center;
		justify-content: center;
		width: 66px;
		height: 66px;
		background-color: var(--background-content);
		border-radius: var(--radii-10);
	}

	.hamburger-button {
		display: flex;
		flex-direction: column;
		justify-content: space-between;
		width: 32px;
		height: 24px;
		background: transparent;
		border: none;
		cursor: pointer;
		padding: 0;
		z-index: 1001;
		position: relative;
	}

	.hamburger-line {
		width: 100%;
		height: 3px;
		background-color: var(--text-main);
		border-radius: 2px;
		transition: all 0.3s ease-in-out;
		transform-origin: center;
	}

	/* Hamburger animation to X */
	.hamburger-button.active .hamburger-line:nth-child(1) {
		transform: translateY(10.5px) rotate(45deg);
	}

	.hamburger-button.active .hamburger-line:nth-child(2) {
		opacity: 0;
		transform: translateX(-100%);
	}

	.hamburger-button.active .hamburger-line:nth-child(3) {
		transform: translateY(-10.5px) rotate(-45deg);
	}

	/* Mobile menu */
	.mobile-menu {
		position: absolute;
		top: calc(100% + 8px);
		right: 0;
		min-width: 90vw;
		background: var(--background-secondary);
		border: 1px solid var(--button-border-color);
		border-radius: var(--radii-10);
		opacity: 0;
		visibility: hidden;
		transform: translateY(-10px);
		transition: all 0.3s ease-in-out;
		z-index: 1000;
		padding: 16px;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
	}

	.mobile-menu.active {
		opacity: 1;
		visibility: visible;
		transform: translateY(0);
	}

	.menu-list {
		list-style: none;
		padding: 0;
		margin: 0;
		display: flex;
		flex-direction: column;
		gap: 8px;
	}

	.menu-item {
		opacity: 0;
		transform: translateY(-5px);
		transition: all 0.2s ease-in-out;
	}

	.menu-item:hover {
		text-decoration: underline;
	}

	.mobile-menu.active .menu-item {
		opacity: 1;
		transform: translateY(0);
	}

	/* Stagger animation for menu items */
	.mobile-menu.active .menu-item:nth-child(1) {
		transition-delay: 0.05s;
	}

	.mobile-menu.active .menu-item:nth-child(2) {
		transition-delay: 0.1s;
	}

	.mobile-menu.active .menu-item:nth-child(3) {
		transition-delay: 0.15s;
	}

	.mobile-menu.active .menu-item:nth-child(4) {
		transition-delay: 0.2s;
	}

	.mobile-menu.active .menu-item:nth-child(5) {
		transition-delay: 0.25s;
	}

	.menu-link {
		color: var(--text-main);
		text-decoration: none;
		font-size: 16px;
		font-weight: 300;
		font-family: var(--ff-heading);
		transition: all 0.2s ease;
		display: block;
		padding: 12px 16px;
		border-radius: 6px;
		white-space: nowrap;
	}

	.menu-link:hover {
		text-decoration: underline;
	}

	/* Hide on desktop */
	@media (min-width: 901px) {
		.hamburger-wrapper {
			display: none;
		}
	}
</style>

<script>
	const hamburgerButton = document.querySelector(".hamburger-button");
	const mobileMenu = document.querySelector(".mobile-menu");

	if (hamburgerButton && mobileMenu) {
		hamburgerButton.addEventListener("click", () => {
			const isActive = hamburgerButton.classList.contains("active");

			// Toggle active classes
			hamburgerButton.classList.toggle("active");
			mobileMenu.classList.toggle("active");

			// Update aria attributes
			hamburgerButton.setAttribute(
				"aria-expanded",
				(!isActive).toString()
			);
			mobileMenu.setAttribute("aria-hidden", isActive.toString());
		});

		// Close menu when clicking on a link
		const menuLinks = document.querySelectorAll(".menu-link");
		menuLinks.forEach((link) => {
			link.addEventListener("click", () => {
				hamburgerButton.classList.remove("active");
				mobileMenu.classList.remove("active");
				hamburgerButton.setAttribute("aria-expanded", "false");
				mobileMenu.setAttribute("aria-hidden", "true");
			});
		});

		// Close menu when clicking outside
		document.addEventListener("click", (e) => {
			const target = e.target as Node;
			if (
				!hamburgerButton.contains(target) &&
				!mobileMenu.contains(target) &&
				hamburgerButton.classList.contains("active")
			) {
				hamburgerButton.classList.remove("active");
				mobileMenu.classList.remove("active");
				hamburgerButton.setAttribute("aria-expanded", "false");
				mobileMenu.setAttribute("aria-hidden", "true");
			}
		});

		// Close menu on escape key
		document.addEventListener("keydown", (e) => {
			if (
				e.key === "Escape" &&
				hamburgerButton.classList.contains("active")
			) {
				hamburgerButton.classList.remove("active");
				mobileMenu.classList.remove("active");
				hamburgerButton.setAttribute("aria-expanded", "false");
				mobileMenu.setAttribute("aria-hidden", "true");
			}
		});
	}
</script>
